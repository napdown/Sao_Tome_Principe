"0","Tmax<-ee$ImageCollection(""IDAHO_EPSCOR/TERRACLIMATE"")$"
"0","  select('tmmx')"
"0",""
"0","Tmax_principe<-ee_extract(x=Tmax, y=principe, fun=ee$Reducer$mean())"
"2","The image scale is set to 1000.
"
"0","#Tmax_stp2<-ee_extract(x=Tmax, y=stp2_sf, fun=ee$Reducer$mean())"
"0",""
"0","Tmaxlong<-pivot_longer(Tmax_principe,cols = 13:768,names_to = 'month',values_to = 'tmax')"
"0","Tmaxlong$Date<-seq(as.Date('1958-01-01'), by=""month"", length.out=756)"
"0",""
"0","Tmaxlong$tmax<-Tmaxlong$tmax*0.1"
"0"," "
"0",""
"0","tmax_ann<-Tmaxlong%>%mutate(year=year(Date), month=month(Date))%>%"
"0","  group_by(year)%>%  summarise(tmax=mean(tmax))"
"0",""
"0","tmax_mon<-Tmaxlong%>%mutate(year=year(Date), month=month(Date))%>%"
"0","  group_by(month)%>%  summarise(tmax=mean(tmax))"
"0",""
"0","#tmax_ts<-xts(Tmaxlong$tmax,Tmaxlong$Date)"
"0",""
"0",""
"0","#Tmin"
"0","Tmin<-ee$ImageCollection(""IDAHO_EPSCOR/TERRACLIMATE"")$"
"0","  select('tmmn')"
"0",""
"0","Tmin_principe<-ee_extract(x=Tmin, y=principe, fun=ee$Reducer$mean())"
"2","The image scale is set to 1000.
"
"0","#Tmin_stp2<-ee_extract(x=Tmin, y=stp2_sf, fun=ee$Reducer$mean())"
"0",""
"0","Tminlong<-pivot_longer(Tmin_principe,cols = 13:768,names_to = 'month',values_to = 'tmin')"
"0","Tminlong$Date<-seq(as.Date('1958-01-01'), by=""month"", length.out=756)"
"0","Tminlong$tmin<-Tminlong$tmin*0.1"
"0"," "
"0","tmin_ann<-Tminlong%>%mutate(year=year(Date), month=month(Date))%>%"
"0","  group_by(year)%>%  summarise(tmin=mean(tmin))"
"0",""
"0","tmin_mon<-Tminlong%>%mutate(year=year(Date), month=month(Date))%>%"
"0","  group_by(month)%>%  summarise(tmin=mean(tmin))"
"0",""
"0","mytemp<-cbind(Tmaxlong[,14:15], Tminlong[,14])"
"0","mytemp$tmean<-(mytemp$tmax+mytemp$tmin)/2"
"0",""
"0","#pr"
"0","pr<-ee$ImageCollection(""IDAHO_EPSCOR/TERRACLIMATE"")$"
"0","  select('pr')"
"0",""
"0","pr_principe<-ee_extract(x=pr, y=principe, fun=ee$Reducer$mean())"
"2","The image scale is set to 1000.
"
"0","#pr_stp2<-ee_extract(x=pr, y=stp2_sf, fun=ee$Reducer$mean())"
"0",""
"0","prlong<-pivot_longer(pr_principe,cols = 13:768,names_to = 'month',values_to = 'pr')"
"0","prlong$Date<-seq(as.Date('1958-01-01'), by=""month"", length.out=756)"
"0",""
"0","pr_ann<-prlong%>%mutate(year=year(Date), month=month(Date))%>%"
"0","  group_by(year)%>%  summarise(pr=mean(pr))"
"0",""
"0","pr_mon<-prlong%>%mutate(year=year(Date), month=month(Date))%>%"
"0","  group_by(month)%>%  summarise(pr=mean(pr))"
"0",""
"0","#pr_ts<-xts(prlong$pr,prlong$Date)"
"0",""
"0","#combine pr and temp"
"0","pr_temp<-cbind(mytemp,prlong[,14])"
"0",""
"0","df_mon<-pr_temp%>%mutate(year=year(Date), month=month(Date))%>%"
"0","  group_by(month)%>%  summarise(pr=mean(pr),tmean=mean(tmean))"
"0",""
"0","df_mon$month<-factor(df_mon$month, "
"0","                     levels = c('7','8','9','10','11','12','1','2','3','4','5','6'))"
"0",""
"0",""
"0","# plot"
"0",""
"0","ty<-list(overlaying = ""y"","
"0","  side = ""right"","
"0","  title = ""Temperature (Â°C)"","
"0","  autotick = F,"
"0","  showticklabels=T,"
"0","      dtick = 5,"
"0"," range=c(min(df_mon$tmean),max(df_mon$tmean))"
"0","  )"
"0",""
"0","plotly::plot_ly(type= 'bar', data= df_mon, x= ~month, y= ~pr, name = 'Precipitation')%>%"
"0","  plotly::add_lines(x= ~month, y= ~tmean, mode = 'lines+markers',name= 'Temperature', yaxis='y2')%>%"
"0","  #plotly::add_markers(x= ~Month, y= ~tmean, pch=1,color='#D21919', yaxis='y2', name='')%>%"
"0","    plotly::layout(legend=list(orientation='h', y=-0.08,x=0.7), yaxis=list(title='Precipitation (mm)',showticklables=F),width=700, height=450, title='Principe \n (Mean 1958-2020)', yaxis2=ty)"
"2","Warning:"
"2"," Specifying width/height in layout() is now deprecated.
Please specify in ggplotly() or plot_ly()
"
